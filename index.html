<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>ONE LOTO - Reservas</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&display=swap" rel="stylesheet" />
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{
  font-family:'Poppins',sans-serif;
  background: linear-gradient(135deg,#4b0082,#800080);
  display:flex;justify-content:center;align-items:flex-start;
  min-height:100vh;padding:2rem;color:#fff;
}
.card{
  background:#2e003e;
  border-radius:20px;
  padding:2rem;
  max-width:600px;
  width:100%;
  box-shadow:0 0 20px rgba(255,255,255,0.15);
  text-align:center;
  border:2px solid #ffda77;
  display:flex;
  flex-direction:column;
  gap:1.5rem;
}
h1{
  font-size:2.2rem;
  color:#ffccff;
  font-weight:700;
}
label{font-weight:600;text-align:left;color:#ffd700;font-size:1.1rem;margin-bottom:0.3rem;display:block;}
input[type="text"]{
  width:100%;padding:12px;border-radius:10px;border:none;background:#3b1a57;color:#fff;font-size:1.1rem;margin-bottom:1rem;
}
.cotacoes{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:12px;
  margin-top:0.5rem;
}
.cota-opcao{cursor:pointer;user-select:none;display:block;}
.cota-opcao input[type="radio"]{display:none;}
.box-cota{
  background:#3b1a57;
  border-radius:15px;
  padding:15px 0;
  font-weight:700;
  color:#ffda77;
  font-size:1.2rem;
  border:2px solid transparent;
  transition:all 0.3s ease;
  text-align:center;
  box-shadow:0 0 10px rgba(255,218,119,0.25);
}
.box-cota:hover{background:linear-gradient(135deg,#5e2b9f,#8133c9);border-color:#ffd700;box-shadow:0 0 15px #ffd700;color:#fff;}
input[type="radio"]:checked + .box-cota{background:linear-gradient(135deg,#6b3db0,#a267e8);border-color:#ffda77;color:#fff;box-shadow:0 0 20px #ffda77;}
.box-cota.disabled{opacity:0.4;cursor:not-allowed;}
button{
  margin-top:1rem;width:100%;padding:16px;
  background:linear-gradient(to right,#ffd700,#ff9a00);
  border:none;border-radius:12px;font-weight:700;color:#000;font-size:1.2rem;
  cursor:pointer;transition:transform 0.3s ease;animation:pulse 2.5s infinite;box-shadow:0 0 10px #ffda77;
}
button:hover{transform:scale(1.05);box-shadow:0 0 20px #ffd700,0 0 30px #ff9a00;}
@keyframes pulse{0%{transform:scale(1);}50%{transform:scale(1.05);}100%{transform:scale(1);}}
#mensagem{margin-top:1rem;padding:12px;border-radius:12px;font-weight:700;font-size:1.1rem;display:none;word-break:break-word;}
#mensagem.sucesso{background-color:#4caf50;color:#fff;}
#mensagem.erro{background-color:#e53935;color:#fff;}
.info-bolao{
  margin-top:20px;padding:15px;background:#350055;border-radius:15px;color:#ffd700;font-weight:600;box-shadow:0 0 15px #ffda77;font-size:1rem;line-height:1.5;text-align:left;
}
.info-bolao p{margin:5px 0;}
</style>
</head>
<body>
<main class="card">
  <h1>üíú ONE LOTO üíú</h1>

  <form id="formulario" novalidate>
    <label for="nome">Seu nome:</label>
    <input type="text" id="nome" name="nome" placeholder="Digite seu nome completo" required />

    <label>Escolha sua dezena:</label>
    <div class="cotacoes" id="cotacoes"></div>

    <button type="submit">‚úÖ Reservar Dezena</button>
  </form>

  <section class="info-bolao">
    <p>üíú <strong>ONE LOTO</strong> üíú</p>
    <p>üí∞ Valor por dezena: R$15,00</p>
    <p>ü•≥ Pr√™mio fixo: R$263,00</p>
    <p>üí∏ Todo dia tem 1 Ganhador</p>
    <p>‚ö†Ô∏è Cada dezena s√≥ pode ser comprada uma vez!</p>
    <p>‚åö Pagamento at√© as <strong>17:00</strong></p>
  </section>

  <div id="mensagem"></div>
</main>

<script>
// URL do seu App Script publicado (/exec)
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzMl_5l0Y5Rs72nj3PUiazswWwSWbdmFPRzzjZfgdhe6DYvTBFH3L7oxhFk4BaTxsFE/exec";

// Cria dezenas 1 a 25
const container = document.getElementById('cotacoes');
for(let i=1;i<=25;i++){
  const label = document.createElement('label');
  label.className='cota-opcao';
  label.innerHTML=`<input type="radio" name="dezena" value="${i}"><div class="box-cota">${i}</div>`;
  container.appendChild(label);
}

const formulario = document.getElementById('formulario');
const mensagem = document.getElementById('mensagem');

// Ao carregar, busca quais dezenas j√° est√£o ocupadas
async function carregarReservas(){
  try{
    const res = await fetch(SCRIPT_URL);
    const reservadas = await res.json();
    document.querySelectorAll('.box-cota').forEach(box=>{
      const val = parseInt(box.textContent);
      if(reservadas.includes(String(val))){
        box.classList.add('disabled');
        box.previousElementSibling.disabled=true;
      }
    });
  }catch(err){
    console.error("Erro ao carregar reservas:",err);
  }
}
carregarReservas();

formulario.addEventListener('submit', async e=>{
  e.preventDefault();
  const nome = document.getElementById('nome').value.trim();
  const dezena = document.querySelector('input[name="dezena"]:checked')?.value;

  if(!nome || !dezena){
    mensagem.textContent='‚ùå Preencha seu nome e escolha uma dezena.';
    mensagem.className='erro';
    mensagem.style.display='block';
    return;
  }

  try{
    const resposta = await fetch(SCRIPT_URL,{
      method:'POST',
      body: JSON.stringify({nome, dezena})
    });
    const result = await resposta.json();

    mensagem.textContent = result.msg;
    mensagem.className = result.status === "ok" ? "sucesso" : "erro";
    mensagem.style.display='block';

    if(result.status==="ok"){ carregarReservas(); formulario.reset(); }
  }catch(err){
    mensagem.textContent='‚ùå Erro ao conectar com o servidor.';
    mensagem.className='erro';
    mensagem.style.display='block';
  }
});
</script>
</body>
</html>
